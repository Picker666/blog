(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{628:function(t,a,s){"use strict";s.r(a);var e=s(54),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"nextjs-渲染方式的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nextjs-渲染方式的区别"}},[t._v("#")]),t._v(" NextJs 渲染方式的区别")]),t._v(" "),s("h2",{attrs:{id:"ssr-server-side-rendering"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ssr-server-side-rendering"}},[t._v("#")]),t._v(" SSR(Server-side Rendering)")]),t._v(" "),s("h3",{attrs:{id:"特点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),s("ul",[s("li",[t._v("每次请求页面时候生成html；")]),t._v(" "),s("li",[t._v("export async function getServerSideProps")])]),t._v(" "),s("h3",{attrs:{id:"运行时机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行时机"}},[t._v("#")]),t._v(" 运行时机")]),t._v(" "),s("ul",[s("li",[t._v("直接请求页面时候，请求的时候运行 getServerSideProps，并以其结果作为组件的props；")]),t._v(" "),s("li",[t._v("在客户端通过 next/link 或者 next/router 跳转时，nextjs向运行 getServerSideProps 的服务器发送请求，运行getServerSideProps。")])]),t._v(" "),s("h3",{attrs:{id:"适用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用场景"}},[t._v("#")]),t._v(" 适用场景")]),t._v(" "),s("p",[t._v("每次请求页面都需要最新数据；")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("只有header配置cache-control才能被缓存；")]),t._v(" "),s("p",[t._v("res.setHeader(\n'Cache-Control',\n'public, s-maxage=10, stale-while-revalidate=59',\n);")])]),t._v(" "),s("h2",{attrs:{id:"ssg-static-site-generation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ssg-static-site-generation"}},[t._v("#")]),t._v(" SSG(Static Site Generation)")]),t._v(" "),s("h3",{attrs:{id:"适用于ssg的场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用于ssg的场景"}},[t._v("#")]),t._v(" 适用于SSG的场景")]),t._v(" "),s("ul",[s("li",[t._v("不需要依赖外部数据的页面；")]),t._v(" "),s("li",[t._v("需要外部数据进行与渲染，内容依赖外部数据（getStaticProps）和路径依赖外部数据（getStaticPaths）；")])]),t._v(" "),s("h3",{attrs:{id:"特点-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特点-2"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),s("ul",[s("li",[t._v("可以是，返回 async getStaticProps/getStaticPaths 方法，也可以是纯React组件；")]),t._v(" "),s("li",[t._v("构建时生成静态html，调用getStaticProps/getStaticPaths，并把其结果生成JSON文件；")]),t._v(" "),s("li",[t._v("请求该页面时，传递json数据作为 组件的props，进行与预渲染；")])]),t._v(" "),s("h3",{attrs:{id:"适用-getstaticprops-的场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用-getstaticprops-的场景"}},[t._v("#")]),t._v(" 适用 getStaticProps 的场景")]),t._v(" "),s("ul",[s("li",[t._v("该数据是页面渲染必须的数据，需要保证用户请求之前，构建时可用；")]),t._v(" "),s("li",[t._v("数据来自 headless CMS ？")]),t._v(" "),s("li",[t._v("页面必须预渲染（SEO）和快速响应，使用 getStaticProps 可在构建时生成 html和json数据，并通过cdn缓存，以提高性能；")]),t._v(" "),s("li",[t._v("数据可以被公开缓存。可以通过中间件重写路径绕过此条件。")])]),t._v(" "),s("h3",{attrs:{id:"getstaticprops-运行时机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getstaticprops-运行时机"}},[t._v("#")]),t._v(" getStaticProps 运行时机")]),t._v(" "),s("ul",[s("li",[t._v("构建时（next build）")]),t._v(" "),s("li",[t._v("fallback:true, 运行在后台")]),t._v(" "),s("li",[t._v("fallback：blocking，初始渲染之前调用")]),t._v(" "),s("li",[t._v("使用revalidate 时，在后台运行")]),t._v(" "),s("li",[t._v("使用revalidate 时，在后台"),s("strong",[t._v("按需")]),t._v("运行")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("当与增量静态再生（Incremental Static Regeneration）相结合时，getStaticProps将在后台运行，同时重新验证过时的页面，并将新页面提供给浏览器。")]),t._v(" "),s("p",[t._v("getStaticProps无法访问传入请求（如查询参数或HTTP标头），因为它生成静态HTML。如果您需要访问页面请求，请考虑除了使用getStaticProps之外还使用中间件。")])]),t._v(" "),s("h3",{attrs:{id:"适用-getstaticpaths-的场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用-getstaticpaths-的场景"}},[t._v("#")]),t._v(" 适用 getStaticPaths 的场景")]),t._v(" "),s("p",[t._v("前提：如果一个页面是 "),s("strong",[t._v("动态路由")]),t._v(" 并且使用了 "),s("strong",[t._v("getStaticProps")]),t._v(" 方法，这时候需要定义个静态生成的路径列表；")]),t._v(" "),s("ul",[s("li",[t._v("页面数据来自headless CMS")]),t._v(" "),s("li",[t._v("页面数据来自数据库")]),t._v(" "),s("li",[t._v("页面数据来自文件系统")]),t._v(" "),s("li",[t._v("数据可以被公开缓存")]),t._v(" "),s("li",[t._v("页面必须预渲染（SEO）和快速响应，使用 getStaticProps 可在构建时生成 html和json数据，并通过cdn缓存，以提高性能。")])]),t._v(" "),s("h3",{attrs:{id:"getstaticpaths-运行时机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getstaticpaths-运行时机"}},[t._v("#")]),t._v(" getStaticPaths 运行时机")]),t._v(" "),s("ul",[s("li",[t._v("构建时（next build）")]),t._v(" "),s("li",[t._v("fallback:true, 运行在后台")]),t._v(" "),s("li",[t._v("fallback：blocking，初始渲染之前调用。")])]),t._v(" "),s("h3",{attrs:{id:"getstaticpaths-可以用在哪"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getstaticpaths-可以用在哪"}},[t._v("#")]),t._v(" getStaticPaths 可以用在哪")]),t._v(" "),s("ul",[s("li",[t._v("必须和getStaticProps一起使用")]),t._v(" "),s("li",[t._v("不能和getServerSideProps 一起使用")]),t._v(" "),s("li",[t._v("不能在"),s("strong",[t._v("非page")]),t._v("文件下使用")]),t._v(" "),s("li",[t._v("不能作为组件的属性")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("按需生成，过多的生成将会降低build速度")])]),t._v(" "),s("h2",{attrs:{id:"isr-incremental-static-regeneration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#isr-incremental-static-regeneration"}},[t._v("#")]),t._v(" ISR(Incremental Static Regeneration)")]),t._v(" "),s("h3",{attrs:{id:"特点-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特点-3"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),s("ul",[s("li",[t._v("getStaticProps 方法返回值中添加 revalidate：number，最多多少秒刷新一下page；")]),t._v(" "),s("li",[t._v("revalidate 在服务端使用response.revalidate(path) 来重新验证路由api")])])])}),[],!1,null,null,null);a.default=r.exports}}]);